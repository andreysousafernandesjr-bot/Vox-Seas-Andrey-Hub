local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local rootPart = character:WaitForChild("HumanoidRootPart")

-- Conexões
local killAuraConnection
local bringMobsConnection
local autoFarmConnection
local infiniteJumpConnection
local walkSpeedConnection
local autoFarmAllMobsConnection
local autoFarmSelectedMobConnection

-- Configs
local killDistance = 20
local infiniteJumpEnabled = false
local walkSpeedValue = 16
local walkSpeedEnabled = false
local selectedMobName = nil

-- Função para pegar dados do personagem
local function getCharacterData()
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    return char, hrp, humanoid
end

-- Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Vox Seas Andrey Hub Versão Beta",
   Icon = 0,
   LoadingTitle = "Andrey Hub",
   LoadingSubtitle = "Criado por Andreyjr0250",
   ShowText = "Andrey Hub",
   Theme = "Green",
   ToggleUIKeybind = "K",
   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,
   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Andrey Hub"
   },
   Discord = {
      Enabled = true,
      Invite = "KkVZEcwN",
      RememberJoins = true
   },
   KeySystem = false
})

-- Tabs
local infotab = Window:CreateTab("InfoTab", 4483362458)
local farmtab = Window:CreateTab("FarmTab", 4483362458)
local configtab = Window:CreateTab("ConfiguraçõesTab", 4483362458)
local discordtab = Window:CreateTab("DiscordTab", 4483362458)

-- Labels
infotab:CreateLabel("Vox Seas Andrey Hub", 4483362458, Color3.fromRGB(255, 255, 255), false)
farmtab:CreateLabel("Auto Farm", 4483362458, Color3.fromRGB(255, 255, 255), false)
farmtab:CreateLabel("Game", 4483362458, Color3.fromRGB(255, 255, 255), false)
discordtab:CreateLabel("Entre No Nosso Discord Para Pegar as Atualizações", 4483362458, Color3.fromRGB(114, 137, 218), false)
discordtab:CreateLabel("https://discord.gg/KkVZEcwN", 4483362458, Color3.fromRGB(114, 137, 218), false)

-- Kill Nearby Mobs
farmtab:CreateToggle({
   Name = "Kill Nearby Mobs",
   CurrentValue = false,
   Flag = "KillAuraToggle",
   Callback = function(Value)
      if Value then
         killAuraConnection = RunService.Heartbeat:Connect(function()
            local char, hrp = getCharacterData()
            for _, mob in ipairs(workspace:GetDescendants()) do
               if mob:IsA("Model") and mob ~= char then
                  local humanoid = mob:FindFirstChildOfClass("Humanoid")
                  local mobRoot = mob:FindFirstChild("HumanoidRootPart")
                  if humanoid and mobRoot and humanoid.Health > 0 then
                     local distance = (hrp.Position - mobRoot.Position).Magnitude
                     if distance <= killDistance then
                        humanoid.Health = 0
                     end
                  end
               end
            end
         end)
      else
         if killAuraConnection then
            killAuraConnection:Disconnect()
            killAuraConnection = nil
         end
      end
   end
})

-- Bring Nearby Mobs
farmtab:CreateToggle({
   Name = "Bring Nearby Mobs",
   CurrentValue = false,
   Flag = "BringMobsToggle",
   Callback = function(Value)
      if Value then
         bringMobsConnection = RunService.Heartbeat:Connect(function()
            local char, hrp = getCharacterData()
            for _, mob in ipairs(workspace:GetDescendants()) do
               if mob:IsA("Model") and mob ~= char then
                  local humanoid = mob:FindFirstChildOfClass("Humanoid")
                  local mobRoot = mob:FindFirstChild("HumanoidRootPart")
                  if humanoid and mobRoot and humanoid.Health > 0 then
                     local distance = (hrp.Position - mobRoot.Position).Magnitude
                     if distance <= killDistance then
                        mobRoot.CFrame = hrp.CFrame * CFrame.new(math.random(-3,3), 0, math.random(-3,3))
                     end
                  end
               end
            end
         end)
      else
         if bringMobsConnection then
            bringMobsConnection:Disconnect()
            bringMobsConnection = nil
         end
      end
   end
})

-- Auto Farm Level
farmtab:CreateToggle({
   Name = "Auto Farm Level",
   CurrentValue = false,
   Flag = "AutoFarmToggle",
   Callback = function(Value)
      if Value then
         autoFarmConnection = RunService.Heartbeat:Connect(function()
            local char, hrp = getCharacterData()
            -- Procurar NPC de missão
            local nearestQuestNPC, nearestDist
            for _, npc in ipairs(workspace:GetDescendants()) do
               if npc:IsA("Model") and npc:FindFirstChild("QuestGiver") then
                  local npcRoot = npc:FindFirstChild("HumanoidRootPart") or npc:FindFirstChild("Head")
                  if npcRoot then
                     local dist = (hrp.Position - npcRoot.Position).Magnitude
                     if not nearestDist or dist < nearestDist then
                        nearestQuestNPC = npc
                        nearestDist = dist
                     end
                  end
               end
            end

            if nearestQuestNPC and nearestDist and nearestDist < 30 then
               local npcRoot = nearestQuestNPC:FindFirstChild("HumanoidRootPart") or nearestQuestNPC:FindFirstChild("Head")
               if npcRoot then
                  firetouchinterest(hrp, npcRoot, 0)
                  wait(0.2)
                  firetouchinterest(hrp, npcRoot, 1)
               end
            end

            -- Matar mobs da missão
            for _, mob in ipairs(workspace:GetDescendants()) do
               if mob:IsA("Model") and mob ~= char then
                  local humanoid = mob:FindFirstChildOfClass("Humanoid")
                  local mobRoot = mob:FindFirstChild("HumanoidRootPart")
                  if humanoid and mobRoot and humanoid.Health > 0 then
                     local distance = (hrp.Position - mobRoot.Position).Magnitude
                     if distance <= 30 then
                        humanoid.Health = 0
                     end
                  end
               end
            end
         end)
      else
         if autoFarmConnection then
            autoFarmConnection:Disconnect()
            autoFarmConnection = nil
         end
      end
   end
})

-- Infinite Jump
configtab:CreateToggle({
   Name = "Infinite Jump",
   CurrentValue = false,
   Flag = "InfiniteJumpToggle",
   Callback = function(Value)
      infiniteJumpEnabled = Value
      if infiniteJumpEnabled then
         infiniteJumpConnection = UserInputService.JumpRequest:Connect(function()
            local char, humanoid = getCharacterData()
            if humanoid then
               humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
         end)
      else
         if infiniteJumpConnection then
            infiniteJumpConnection:Disconnect()
            infiniteJumpConnection = nil
         end
      end
   end
})

-- WalkSpeed Slider
configtab:CreateSlider({
   Name = "WalkSpeed",
   Range = {16, 100},
   Increment = 1,
   Suffix = "Velocidade",
   CurrentValue = 16,
   Flag = "WalkSpeedSlider",
   Callback = function(Value)
      walkSpeedValue = Value
      local char, humanoid = getCharacterData()
      if walkSpeedEnabled and humanoid then
         humanoid.WalkSpeed = walkSpeedValue
      end
   end
})

-- Ativar WalkSpeed
configtab:CreateToggle({
   Name = "Ativar WalkSpeed",
   CurrentValue = false,
   Flag = "WalkSpeedToggle",
   Callback = function(Value)
      walkSpeedEnabled = Value
      local char, humanoid = getCharacterData()
      if humanoid then
         humanoid.WalkSpeed = walkSpeedEnabled and walkSpeedValue or 16
      end
   end
})

-- Dropdown para selecionar mob
local Dropdown = farmtab:CreateDropdown({
   Name = "Selecionar Mob para Auto Farm",
   Options = {"Mob1", "Mob2", "Mob3"},
   CurrentOption = {"Mob1"},
   MultipleOptions = false,
   Flag = "DropdownMobAutoFarm",
   Callback = function(Options)
      selectedMobName = Options[1]
   end,
})

-- Auto Farm Mob Selecionado
farmtab:CreateToggle({
   Name = "Auto Farm Mob Selecionado",
   CurrentValue = false,
   Flag = "AutoFarmSelectedMobToggle",
   Callback = function(Value)
      if Value then
         autoFarmSelectedMobConnection = RunService.Heartbeat:Connect(function()
            local char, hrp = getCharacterData()
            if selectedMobName then
               for _, mob in ipairs(workspace:GetDescendants()) do
                  if mob:IsA("Model") and mob.Name == selectedMobName then
                     local humanoid = mob:FindFirstChildOfClass("Humanoid")
                     local mobRoot = mob:FindFirstChild("HumanoidRootPart")
                     if humanoid and humanoid.Health > 0 and mobRoot then
                        local distance = (hrp.Position - mobRoot.Position).Magnitude
                        if distance <= killDistance then
                           humanoid.Health = 0
                        end
                     end
                  end
               end
            end
         end)
      else
         if autoFarmSelectedMobConnection then
            autoFarmSelectedMobConnection:Disconnect()
            autoFarmSelectedMobConnection = nil
         end
      end
   end,
})
